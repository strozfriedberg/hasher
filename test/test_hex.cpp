#include "hex.h"

#include <string>
#include <vector>

#include <scope/test.h>

SCOPE_TEST(to_hexTest) {
  const std::vector<std::pair<std::string, std::vector<uint8_t>>> tests{
    { "", { } },
    { "0a", { 0x0A } },
    {
      "0123456789abcdef",
      { 0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF }
    },
    {
      "0000000000000000000000000000000000000000",
      {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
      }
    },
    {
      "ffffffffffffffffffffffffffffffffffffffff",
      {
        0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
        0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF
      }
    }
  };

  for (const auto& t: tests) {
    SCOPE_ASSERT_EQUAL(std::get<0>(t), to_hex(std::get<1>(t)));
  }
}
